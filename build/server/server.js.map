{"version":3,"sources":["server.js"],"names":["compress","flush","Z_PARTIAL_FLUSH","Server","port","dbObject","_app","set","process","env","PORT","_port","get","use","_db","static","resolve","__dirname","secret","resave","saveUninitialized","cookie","maxAge","urlencoded","extended","req","res","status","send","err","next","listen","console","log","bgBlue","bold"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;AAEA,IAAMA,WAAW,2BAAY;AAC3BC,SAAO,eAAKC;AADe,CAAZ,CAAjB;;IAIqBC,M;AACnB,kBAAYC,IAAZ,EAAkBC,QAAlB,EAA4B;AAAA;;AAC1B,SAAKC,IAAL,GAAY,wBAAZ;AACA,SAAKA,IAAL,CAAUC,GAAV,CAAc,MAAd,EAAsBC,QAAQC,GAAR,CAAYC,IAAZ,IAAoBN,IAA1C;AACA,SAAKO,KAAL,GAAa,KAAKL,IAAL,CAAUM,GAAV,CAAc,MAAd,CAAb;AACA,SAAKN,IAAL,CAAUO,GAAV,CAAcb,QAAd;AACA,SAAKc,GAAL,GAAWT,QAAX;AACA,SAAKC,IAAL,CAAUO,GAAV,CAAc,MAAd,EAAsB,kBAAQE,MAAR,CAAe,eAAKC,OAAL,CAAaC,SAAb,EAAwB,eAAxB,CAAf,CAAtB;AACA,SAAKX,IAAL,CAAUO,GAAV,CAAc,KAAd,EAAqB,kBAAQE,MAAR,CAAe,eAAKC,OAAL,CAAaC,SAAb,EAAwB,mBAAxB,CAAf,CAArB;;AAEA,SAAKX,IAAL,CAAUC,GAAV,CAAc,aAAd,EAA6B,CAA7B;;AAEA,SAAKD,IAAL,CAAUO,GAAV,CAAc,8BAAQ;AACpBK,cAAQ,gBAAM,gBAAN,CADY;AAEpBC,cAAQ,KAFY;AAGpBC,yBAAmB,IAHC;AAIpBC,cAAQ,EAAEC,QAAQ,MAAM,EAAN,GAAW,EAAX,GAAgB,EAAhB,GAAqB,IAA/B;AAJY,KAAR,CAAd;;AAOA,SAAKhB,IAAL,CAAUO,GAAV,CAAc,6BAAd;;AAEA,SAAKP,IAAL,CAAUO,GAAV,CAAc,qBAAWU,UAAX,CAAsB,EAAEC,UAAU,KAAZ,EAAtB,CAAd;;AAEA,SAAKlB,IAAL,CAAUO,GAAV;AACA,SAAKP,IAAL,CAAUO,GAAV,CAAc,MAAd;;AAEA,SAAKP,IAAL,CAAUO,GAAV,CAAc,UAACY,GAAD,EAAMC,GAAN,EAAc;AAC1BA,UAAIC,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,iBAArB;AACD,KAFD;;AAIA,SAAKtB,IAAL,CAAUO,GAAV,CAAc,UAACgB,GAAD,EAAMJ,GAAN,EAAWC,GAAX,EAAgBI,IAAhB,EAAyB;AACrCJ,UAAIC,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,wBAA0CC,GAA1C;AACD,KAFD;AAGD;;;;6BAEQ;AAAA;;AACP,WAAKvB,IAAL,CAAUyB,MAAV,CAAiB,KAAKpB,KAAtB,EAA6B,YAAM;AACjCqB,gBAAQC,GAAR,CAAe,gBAAMC,MAAN,CAAaC,IAAb,CAAkB,WAAlB,CAAf,+CAA6E,MAAKxB,KAAlF;AACD,OAFD;AAGD;;;;;;kBAvCkBR,M","file":"server.js","sourcesContent":["import compression from 'compression';\nimport zlib from 'zlib';\nimport bodyParser from 'body-parser';\nimport express from 'express';\nimport cookieParser from 'cookie-parser';\nimport chalk from 'chalk';\nimport session from 'express-session';\nimport mainRoute from './routes';\nimport apiRoutes from './routes/api';\nimport fourOfourTemp from './templates/404.js';\nimport sData from './sData';\nimport path from 'path';\n\nconst compress = compression({\n  flush: zlib.Z_PARTIAL_FLUSH,\n});\n\nexport default class Server {\n  constructor(port, dbObject) {\n    this._app = express();\n    this._app.set('port', process.env.PORT || port);\n    this._port = this._app.get('port');\n    this._app.use(compress);\n    this._db = dbObject;\n    this._app.use('/css', express.static(path.resolve(__dirname, '../client/css')));\n    this._app.use('/js', express.static(path.resolve(__dirname, '../client/scripts')));\n\n    this._app.set('json spaces', 2);\n\n    this._app.use(session({\n      secret: sData['session-secret'],\n      resave: false,\n      saveUninitialized: true,\n      cookie: { maxAge: 365 * 24 * 60 * 60 * 1000 },\n    }));\n\n    this._app.use(cookieParser());\n\n    this._app.use(bodyParser.urlencoded({ extended: false }));\n\n    this._app.use(mainRoute);\n    this._app.use('/api', apiRoutes);\n\n    this._app.use((req, res) => {\n      res.status(404).send(fourOfourTemp());\n    });\n\n    this._app.use((err, req, res, next) => {\n      res.status(500).send(`An error occured: ${err}`);\n    });\n  }\n\n  listen() {\n    this._app.listen(this._port, () => {\n      console.log(`${chalk.bgBlue.bold('[SERVER]:')} 🌍  Server started on port: ${this._port}`);\n    });\n  }\n}\n"]}