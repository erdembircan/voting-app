{"version":3,"sources":["server.js"],"names":["compress","flush","Z_PARTIAL_FLUSH","Server","port","dbObject","_port","_app","use","_db","static","resolve","__dirname","set","secret","resave","saveUninitialized","cookie","maxAge","urlencoded","extended","req","res","status","send","err","next","listen","console","log","bgBlue","bold"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,WAAW,2BAAY;AAC3BC,SAAO,eAAKC;AADe,CAAZ,CAAjB;;IAIqBC,M;AACnB,kBAAYC,IAAZ,EAAkBC,QAAlB,EAA4B;AAAA;;AAC1B,SAAKC,KAAL,GAAaF,IAAb;AACA,SAAKG,IAAL,GAAY,wBAAZ;AACA,SAAKA,IAAL,CAAUC,GAAV,CAAcR,QAAd;AACA,SAAKS,GAAL,GAAWJ,QAAX;AACA,SAAKE,IAAL,CAAUC,GAAV,CAAc,MAAd,EAAsB,kBAAQE,MAAR,CAAe,eAAKC,OAAL,CAAaC,SAAb,EAAwB,eAAxB,CAAf,CAAtB;AACA,SAAKL,IAAL,CAAUC,GAAV,CAAc,KAAd,EAAqB,kBAAQE,MAAR,CAAe,eAAKC,OAAL,CAAaC,SAAb,EAAwB,mBAAxB,CAAf,CAArB;;AAEA,SAAKL,IAAL,CAAUM,GAAV,CAAc,aAAd,EAA6B,CAA7B;;AAEA,SAAKN,IAAL,CAAUC,GAAV,CAAc,8BAAQ;AACpBM,cAAQ,gBAAM,gBAAN,CADY;AAEpBC,cAAQ,KAFY;AAGpBC,yBAAmB,IAHC;AAIpBC,cAAQ,EAAEC,QAAQ,MAAM,EAAN,GAAW,EAAX,GAAgB,EAAhB,GAAqB,IAA/B;AAJY,KAAR,CAAd;;AAOA,SAAKX,IAAL,CAAUC,GAAV,CAAc,6BAAd;;AAEA,SAAKD,IAAL,CAAUC,GAAV,CAAc,qBAAWW,UAAX,CAAsB,EAAEC,UAAU,KAAZ,EAAtB,CAAd;;AAEA,SAAKb,IAAL,CAAUC,GAAV;AACA,SAAKD,IAAL,CAAUC,GAAV,CAAc,MAAd;;AAEA,SAAKD,IAAL,CAAUC,GAAV,CAAc,UAACa,GAAD,EAAMC,GAAN,EAAc;AAC1BA,UAAIC,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,iBAArB;AACD,KAFD;;AAIA,SAAKjB,IAAL,CAAUC,GAAV,CAAc,UAACiB,GAAD,EAAMJ,GAAN,EAAWC,GAAX,EAAgBI,IAAhB,EAAyB;AACrCJ,UAAIC,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,wBAA0CC,GAA1C;AACD,KAFD;AAGD;;;;6BAEQ;AAAA;;AACP,WAAKlB,IAAL,CAAUoB,MAAV,CAAiB,KAAKrB,KAAtB,EAA6B,YAAM;AACjCsB,gBAAQC,GAAR,CAAe,gBAAMC,MAAN,CAAaC,IAAb,CAAkB,WAAlB,CAAf,+CAA6E,MAAKzB,KAAlF;AACD,OAFD;AAGD;;;;;kBAtCkBH,M","file":"server.js","sourcesContent":["import compression from 'compression';\nimport zlib from 'zlib';\nimport bodyParser from 'body-parser';\nimport express from 'express';\nimport cookieParser from 'cookie-parser';\nimport chalk from 'chalk';\nimport session from 'express-session';\nimport mainRoute from './routes';\nimport apiRoutes from './routes/api';\nimport fourOfourTemp from './templates/404.js';\nimport sData from './sData';\nimport path from 'path';\n\nconst compress = compression({\n  flush: zlib.Z_PARTIAL_FLUSH,\n});\n\nexport default class Server {\n  constructor(port, dbObject) {\n    this._port = port;\n    this._app = express();\n    this._app.use(compress);\n    this._db = dbObject;\n    this._app.use('/css', express.static(path.resolve(__dirname, '../client/css')));\n    this._app.use('/js', express.static(path.resolve(__dirname, '../client/scripts')));\n\n    this._app.set('json spaces', 2);\n\n    this._app.use(session({\n      secret: sData['session-secret'],\n      resave: false,\n      saveUninitialized: true,\n      cookie: { maxAge: 365 * 24 * 60 * 60 * 1000 },\n    }));\n\n    this._app.use(cookieParser());\n\n    this._app.use(bodyParser.urlencoded({ extended: false }));\n\n    this._app.use(mainRoute);\n    this._app.use('/api', apiRoutes);\n\n    this._app.use((req, res) => {\n      res.status(404).send(fourOfourTemp());\n    });\n\n    this._app.use((err, req, res, next) => {\n      res.status(500).send(`An error occured: ${err}`);\n    });\n  }\n\n  listen() {\n    this._app.listen(this._port, () => {\n      console.log(`${chalk.bgBlue.bold('[SERVER]:')} 🌍  Server started on port: ${this._port}`);\n    });\n  }\n}\n"]}